define(function(require,exports){var a=(require("utils/log"),!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent)),b={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.Model.prototype.sync=function(c,d,e){var f=b[c],g={type:f,dataType:"json"};if(e.url||(g.url=_.result(d,"url")||urlError()),null==e.data&&d&&("create"===c||"update"===c||"patch"===c)){g.contentType="application/json";var h=e.attrs||d.toJSON(e);g.data=JSON.stringify(h)}if(e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var i=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),i?i.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1),"PATCH"===g.type&&a&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var j=e.success;e.success=function(a){_.isFunction(j)&&j(a)};var k=e.xhr=Backbone.ajax(_.extend(g,e));return d.trigger("request",d,k,e),k}});