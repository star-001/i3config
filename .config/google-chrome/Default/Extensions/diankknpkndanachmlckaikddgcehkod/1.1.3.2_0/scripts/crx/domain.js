define(function(require,exports){var a=require("configs/settings"),b=require("configs/env"),c=b.domain_tick,d=b.domain_dida,e=b.cookie_domain,f={domain:"",value:""};exports.cookieListener=function(a,b){var c=a.cookie;"t"===c.name&&~e.indexOf(c.domain)&&(a.removed||c.value!=f.value)&&(exports.initCookie(),b&&b())},exports.getCookies=function(b,c,d){root.cookies.get({url:a.protocol+b,name:"t"},function(e){if(e){var f=b!==a.domain;a.domain=b,exports.initDomain(),exports.initCookie(e),c&&c(f)}else d&&d()})},exports.decideFinalDomain=function(b){a.domain=a.iscnlang?d:c,exports.initDomain(),exports.initCookie(),b&&b()},exports.initInfoFromServer=function(b,e){var f=a.domain||(a.iscnlang?d:c);exports.getCookies(f,b,function(){f=f===d?c:d,exports.getCookies(f,b,function(){exports.decideFinalDomain(e)})})},exports.initDomain=function(){a.isCnSites=a.domain.match(/ticktick/)?!1:!0,a.productName=a.isCnSites?"滴答清单":"TickTick",a.api_domain=a.isCnSites?b.api_dida:b.api_tick,a.API_HOST=a.protocol+a.api_domain+"/api/v2",a.API_HOST_V1=a.protocol+a.api_domain+"/api/v1",a.API_HOST_V2=a.protocol+a.api_domain+"/api/v2",a.VERSION_API_HOST=a.protocol+a.api_domain+"/api/v2"},exports.initCookie=function(a){f=a?{domain:a.domain,value:a.value}:{domain:"",value:""}}});