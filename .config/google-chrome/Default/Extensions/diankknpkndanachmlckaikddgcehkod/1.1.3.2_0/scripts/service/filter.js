define(function(require,exports){var a=require("configs/dict"),b=require("dao/projectdb"),c=require("utils/string"),d=require("utils/timeformat"),e=require("utils/calculate"),f=require("configs/settings"),g=exports.filter={todo:function(a){return 0==a.get("status")},deleted:function(a){return a.get("deleted")>0},completed:function(a){return a.get("status")>0},_noDuedate:function(a){return!c.isValidDate(a.get("startDate"))},_isClosed:function(a){return a.get("projectId")?(project=b.db.getProjectById(a.get("projectId")),project?project.get("closed"):!1):void 0},_notInAll:function(a,c){return c=b.db.getNotInAllProjectIds(),_.contains(c,a.get("projectId"))},_getRemindTimeOffsetMinutes:function(b){var c=d.prefMomentFromUtc(b,a.format.atomTime);return c.startOf("minute").diff(d.prefMoment().startOf("minute"),"minutes")},tasksAssignedMe:function(a){return g.deleted(a)?!1:g.completed(a)?!1:g._isClosed(a)?!1:a.get("assignee")===f.user.userId},onTimeTasks:function(a){if(!g.todo(a))return!1;if(g._noDuedate(a))return!1;if(g._isClosed(a))return!1;if(a.get("remindTime")&&0===g._getRemindTimeOffsetMinutes(a.get("remindTime")))return!0;var b=a.get("reminders");if(_.isEmpty(b))return!1;for(var c=a.getCalTime(),d=0;d<b.length;d++){var f=b[d],h=e.remindTime(c,f.trigger);if(0===g._getRemindTimeOffsetMinutes(h))return!0}return!1},countTodoTasks:function(a){return g._notInAll(a,this.notShowInAllIds)?!1:g.completed(a)?!1:g._noDuedate(a)?!1:g._isClosed(a)?!1:d.getDueDateLocalZoneDate(a.get("startDate")).diff(d.prefMoment().startOf("day"),"days")<=0?!0:!1}}});